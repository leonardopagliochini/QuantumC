# QuantumC

QuantumC is an experimental compilation pipeline that turns a subset of C into quantum circuits.  The project orchestrates several stages: generating a JSON AST with Clang, lowering the AST to MLIR, translating the MLIR into a custom quantum dialect, and finally emitting QASM.

## Requirements

- Python 3.10+
- Clang with `-ast-dump=json` support
- [xDSL](https://github.com/xdslproject/xdsl)
- [Qiskit](https://qiskit.org/)

Create a virtual environment and install the Python dependencies:

```bash
python -m venv .venv
source .venv/bin/activate
pip install xdsl qiskit
```

## Running the pipeline

The main entry point is `pipeline.py`.  Without arguments it compiles `c_code/try.c`.

```bash
python pipeline.py                     # Compile default example
python pipeline.py path/to/program.c   # Compile a custom C file
```

Running the script performs the full compilation chain and produces the following artifacts:

1. `json_out/<name>.json` – JSON AST generated by Clang.
2. `mlir_out/<name>_classical.mlir` – classical MLIR produced from the AST.
3. `quantum_mlir_out/<name>_quantum.mlir` – MLIR in the custom quantum dialect.
4. `output/<name>.qasm` – QASM circuit (Clifford+T by default).

### Available flags

`pipeline.py` accepts several optional flags:

- `--run` – simulate the generated circuit with Qiskit. When set, the emitted QASM contains the standard gate set and the circuit is immediately executed.
- `--bits N` – number of bits used to encode integers in the quantum circuit (default `16`).
- `--verbose` – print detailed information during circuit generation.
- `--pretty` – pretty‑print the reconstructed C code from the AST before lowering.
- `--time` – report the total compilation (and simulation) time.

Example usage:

```bash
# Compile and simulate with 8-bit registers, printing extra diagnostics
python pipeline.py c_code/try.c --bits 8 --run --verbose --time
```

## Pipeline stages

- **C → JSON AST** – Clang dumps the abstract syntax tree.
- **AST → classical MLIR** – `step3_dataclasses_to_mlir/mlir_generator.py` lowers the AST into MLIR.
- **Classical MLIR → Quantum MLIR** – `step4_mlir_to_quantum_mlir/quantum_mlir_generator.py` converts the MLIR module into a quantum dialect.
- **Quantum MLIR → QASM** – `step5_quantum_mlir_to_qasm/qasm_generator.py` interprets the quantum MLIR using Qiskit and emits QASM.

Each stage writes its results to the directories mentioned above so intermediate representations can be inspected.

## Repository layout

- `c_code/` – sample C programs.
- `step1_c_to_ast/` … `step5_quantum_mlir_to_qasm/` – modules implementing each compilation step.
- `test_c_file.py` – end-to-end test verifying the pipeline.

## Testing

Run the tests with:

```bash
pytest
```
